{% extends 'Layout_V.html' %}
{% load static %}

{% block title %}Reseñas de Clientes{% endblock %}

{% block content %}
<div class="container-fluid">
    <!-- Header Mejorado con Estadísticas -->
    <div class="tarjeta-bienvenida">
        <div class="row align-items-center">
            <div class="col-md-6">
                <h2>Reseñas de Clientes</h2>
                <p class="text-muted">Gestiona y responde a los comentarios de tus clientes.</p>
            </div>
            <div class="col-md-6">
                <div class="estadisticas-grid">
                    <div class="estadistica-card total">
                        <div class="estadistica-icono">
                            <i class="fas fa-comments"></i>
                        </div>
                        <div class="estadistica-numero">{{ total_resenas }}</div>
                        <div class="estadistica-titulo">Total Reseñas</div>
                    </div>
                    
                    <div class="estadistica-card disponibles">
                        <div class="estadistica-icono">
                            <i class="fas fa-star"></i>
                        </div>
                        <div class="estadistica-numero">{{ promedio_estrellas }}/5</div>
                        <div class="estadistica-titulo">Calificación</div>
                    </div>
                    
                    <div class="estadistica-card oferta">
                        <div class="estadistica-icono">
                            <i class="fas fa-reply"></i>
                        </div>
                        <div class="estadistica-numero">{{ resenas_respondidas }}</div>
                        <div class="estadistica-titulo">Respondidas</div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Layout Dividido Mejorado -->
    <div class="row g-4">
        <!-- Columna Izquierda: Lista de Reseñas -->
        <div class="col-lg-5">
            <div class="seccion-lista-resenas">
                <div class="seccion-header">
                    <h3><i class="fas fa-list me-2"></i>Lista de Reseñas</h3>
                    <span class="contador-seccion" id="contador-resenas">{{ total_resenas }}</span>
                </div>
                
                <div class="contenedor-lista-resenas">
                    {% if resenas %}
                        <div class="lista-resenas" id="lista-resenas">
                            {% for resena in resenas %}
                            <div class="resena-item {% if resena.tiene_respuesta %}resena-respondida{% endif %} {% if resena.reportada %}resena-reportada{% endif %}" 
                                 data-index="{{ forloop.counter0 }}"
                                 data-id="{{ resena.id }}"
                                 onclick="mostrarResena({{ forloop.counter0 }})">
                                <div class="resena-header">
                                    <div class="resena-avatar">
                                        <i class="fas fa-user"></i>
                                    </div>
                                    <div class="resena-info">
                                        <h5 class="resena-cliente">{{ resena.cliente }}</h5>
                                        <div class="resena-meta">
                                            <span class="resena-fecha">
                                                <i class="far fa-clock me-1"></i>{{ resena.fecha }}
                                            </span>
                                            {% if resena.reportada %}
                                            <span class="resena-estado estado-reportada">
                                                <i class="fas fa-flag me-1"></i>Reportada
                                            </span>
                                            {% elif resena.tiene_respuesta %}
                                            <span class="resena-estado estado-respondida">
                                                <i class="fas fa-check-circle me-1"></i>Respondida
                                            {% else %}
                                            <span class="resena-estado estado-pendiente">
                                                <i class="fas fa-clock me-1"></i>Sin respuesta
                                            {% endif %}
                                            </span>
                                        </div>
                                    </div>
                                    <div class="resena-calificacion">
                                        <div class="estrellas-resena">
                                            {% for i in "12345" %}
                                                {% if forloop.counter <= resena.calificacion %}
                                                    <i class="fas fa-star"></i>
                                                {% else %}
                                                    <i class="far fa-star"></i>
                                                {% endif %}
                                            {% endfor %}
                                        </div>
                                        <span class="puntuacion">{{ resena.calificacion }}/5</span>
                                    </div>
                                </div>
                                <div class="resena-comentario">
                                    <p>{{ resena.comentario|truncatewords:20 }}</p>
                                </div>
                            </div>
                            {% endfor %}
                        </div>
                    {% else %}
                        <div class="estado-vacio">
                            <i class="fas fa-comments fa-3x"></i>
                            <h4>Aún no tienes reseñas</h4>
                            <p>Los comentarios de tus clientes aparecerán aquí.</p>
                        </div>
                    {% endif %}
                </div>
            </div>
        </div>

        <!-- Columna Derecha: Detalle y Respuesta -->
        <div class="col-lg-7">
            <div class="seccion-detalle-resena">
                <div class="seccion-header">
                    <h3><i class="fas fa-comment-dots me-2"></i>Detalle de Reseña</h3>
                </div>
                
                <div class="contenedor-detalle-resena">
                    <div id="detalle-resena">
                        <div class="estado-vacio">
                            <i class="fas fa-mouse-pointer fa-2x"></i>
                            <h4>Selecciona una reseña</h4>
                            <p>Haz clic en una reseña de la lista para ver los detalles y responder</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Modal para Reportar Reseña -->
<div class="modal fade" id="modalReportar" tabindex="-1">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">Reportar Reseña</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
            </div>
            <div class="modal-body">
                <form id="form-reportar">
                    {% csrf_token %}
                    <input type="hidden" id="resena_id_reportar" name="resena_id">
                    
                    <div class="mb-3">
                        <label class="form-label">Motivo del Reporte</label>
                        <select class="form-select" id="motivo_reporte" name="motivo" required>
                            <option value="">Selecciona un motivo</option>
                            <option value="contenido_inapropiado">Contenido inapropiado</option>
                            <option value="lenguaje_ofensivo">Lenguaje ofensivo</option>
                            <option value="spam">Spam o publicidad</option>
                            <option value="informacion_falsa">Información falsa</option>
                            <option value="acoso">Acoso o bullying</option>
                            <option value="otro">Otro motivo</option>
                        </select>
                    </div>
                    
                    <div class="mb-3">
                        <label class="form-label">Descripción (opcional)</label>
                        <textarea class="form-control" id="descripcion_reporte" name="descripcion" rows="3" placeholder="Proporciona más detalles sobre el reporte..."></textarea>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secundario" data-bs-dismiss="modal">Cancelar</button>
                <button type="button" class="btn btn-danger" onclick="enviarReporte()">
                    <i class="fas fa-flag me-1"></i> Reportar Reseña
                </button>
            </div>
        </div>
    </div>
</div>

<!-- Template para el detalle de reseña (oculto) -->
<div id="template-resena" style="display: none;">
    <div class="resena-detalle-completa">
        <!-- Header de la reseña -->
        <div class="resena-detalle-header">
            <div class="resena-info-completa">
                <div class="resena-avatar-grande">
                    <i class="fas fa-user"></i>
                </div>
                <div class="resena-datos">
                    <h4 id="detalle-cliente"></h4>
                    <div class="resena-detalle-meta">
                        <span class="fecha-detalle">
                            <i class="far fa-clock me-1"></i>
                            <span id="detalle-fecha"></span>
                        </span>
                        <span class="estado-detalle" id="estado-detalle"></span>
                        <span class="estado-detalle estado-reportada-detalle" id="estado-reportada-detalle" style="display: none;">
                            <i class="fas fa-flag me-1"></i>Reportada
                        </span>
                    </div>
                </div>
            </div>
            <div class="resena-calificacion-detalle">
                <div class="estrellas-grandes" id="detalle-estrellas"></div>
                <span class="puntuacion-grande" id="detalle-calificacion"></span>
            </div>
        </div>

        <!-- Comentario del cliente -->
        <div class="seccion-comentario-cliente">
            <h5 class="titulo-seccion">
                <i class="fas fa-user-edit me-2"></i>
                Comentario del Cliente
            </h5>
            <div class="comentario-cliente">
                <p id="detalle-comentario"></p>
            </div>
        </div>

        <!-- Respuesta Existente -->
        <div class="seccion-respuesta-existente" id="respuesta-existente" style="display: none;">
            <h5 class="titulo-seccion text-success">
                <i class="fas fa-check-circle me-2"></i>
                Tu Respuesta
                <small class="fecha-respuesta" id="fecha-respuesta"></small>
            </h5>
            <div class="respuesta-actual">
                <p id="texto-respuesta"></p>
            </div>
        </div>

        <!-- Botones de Acción -->
        <div class="seccion-acciones-resena">
            <div class="d-flex gap-2 flex-wrap">
                <!-- Formulario de Respuesta -->
                <form method="post" action="" id="form-respuesta" class="flex-grow-1">
                    {% csrf_token %}
                    <div class="campo-respuesta mb-2">
                        <textarea name="respuesta" class="input-respuesta" 
                                  placeholder="Escribe tu respuesta profesional aquí..." 
                                  rows="3" id="textarea-respuesta" required></textarea>
                    </div>
                    <div class="acciones-respuesta">
                        <button type="button" class="btn btn-outline-danger" onclick="mostrarModalReportar()">
                            <i class="fas fa-flag me-1"></i> Reportar
                        </button>
                        <button type="submit" class="btn btn-primario">
                            <i class="fas fa-paper-plane me-1"></i> 
                            <span id="texto-boton">Publicar Respuesta</span>
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block extra_js %}
<script>
// Datos de las reseñas para JavaScript
const resenasData = [
    {% for resena in resenas %}
    {
        id: {{ resena.id }},
        cliente: "{{ resena.cliente|escapejs }}",
        fecha: "{{ resena.fecha }}",
        calificacion: {{ resena.calificacion }},
        comentario: `{{ resena.comentario|escapejs }}`,
        respuesta: `{{ resena.respuesta|escapejs }}`,
        tiene_respuesta: {{ resena.tiene_respuesta|yesno:"true,false" }},
        fecha_respuesta: "{{ resena.fecha_respuesta }}",
        reportada: {{ resena.reportada|yesno:"true,false" }},
        url_responder: "{% url 'responder_resena' resena.id %}",
        url_reportar: "{% url 'reportar_resena' resena.id %}"
    },
    {% endfor %}
];

let resenaSeleccionada = null;

// Función para mostrar reseña en el detalle
function mostrarResena(index) {
    if (index < 0 || index >= resenasData.length) return;
    
    resenaSeleccionada = resenasData[index];
    const template = document.getElementById('template-resena').innerHTML;
    const detalleDiv = document.getElementById('detalle-resena');
    
    detalleDiv.innerHTML = template;
    
    // Llenar datos básicos
    document.getElementById('detalle-cliente').textContent = resenaSeleccionada.cliente;
    document.getElementById('detalle-fecha').textContent = resenaSeleccionada.fecha;
    document.getElementById('detalle-comentario').textContent = resenaSeleccionada.comentario;
    
    // Estrellas
    let estrellasHtml = '';
    for (let i = 1; i <= 5; i++) {
        if (i <= resenaSeleccionada.calificacion) {
            estrellasHtml += '<i class="fas fa-star"></i>';
        } else {
            estrellasHtml += '<i class="far fa-star"></i>';
        }
    }
    document.getElementById('detalle-estrellas').innerHTML = estrellasHtml;
    document.getElementById('detalle-calificacion').textContent = `${resenaSeleccionada.calificacion}/5`;
    
    // Estado - Manejar estado reportada
    const estadoDetalle = document.getElementById('estado-detalle');
    const estadoReportada = document.getElementById('estado-reportada-detalle');
    
    if (resenaSeleccionada.reportada) {
        estadoDetalle.style.display = 'none';
        estadoReportada.style.display = 'inline-block';
    } else {
        estadoReportada.style.display = 'none';
        if (resenaSeleccionada.tiene_respuesta) {
            estadoDetalle.innerHTML = '<i class="fas fa-check-circle me-1"></i>Respondida';
            estadoDetalle.className = 'estado-detalle estado-respondida';
            estadoDetalle.style.display = 'inline-block';
        } else {
            estadoDetalle.innerHTML = '<i class="fas fa-clock me-1"></i>Sin respuesta';
            estadoDetalle.className = 'estado-detalle estado-pendiente';
            estadoDetalle.style.display = 'inline-block';
        }
    }
    
    // Configurar respuesta existente
    const respuestaDiv = document.getElementById('respuesta-existente');
    const form = document.getElementById('form-respuesta');
    const textarea = document.getElementById('textarea-respuesta');
    
    if (resenaSeleccionada.tiene_respuesta) {
        respuestaDiv.style.display = 'block';
        document.getElementById('texto-respuesta').textContent = resenaSeleccionada.respuesta;
        document.getElementById('fecha-respuesta').textContent = resenaSeleccionada.fecha_respuesta ? 
            ` - ${resenaSeleccionada.fecha_respuesta}` : '';
        
        // Cambiar texto del formulario para edición
        document.getElementById('texto-boton').textContent = 'Actualizar Respuesta';
        textarea.value = resenaSeleccionada.respuesta;
    } else {
        respuestaDiv.style.display = 'none';
        document.getElementById('texto-boton').textContent = 'Publicar Respuesta';
        textarea.value = '';
    }
    
    // Actualizar action del formulario
    form.action = resenaSeleccionada.url_responder;
    
    // Resaltar item seleccionado
    document.querySelectorAll('.resena-item').forEach(item => {
        item.classList.remove('activa');
    });
    
    // Encontrar y resaltar el item correcto
    const items = document.querySelectorAll('.resena-item');
    if (items[index]) {
        items[index].classList.add('activa');
    }
}

// Función para mostrar modal de reporte
function mostrarModalReportar() {
    if (!resenaSeleccionada) {
        alert('Por favor selecciona una reseña primero');
        return;
    }
    
    document.getElementById('resena_id_reportar').value = resenaSeleccionada.id;
    document.getElementById('motivo_reporte').value = '';
    document.getElementById('descripcion_reporte').value = '';
    
    const modal = new bootstrap.Modal(document.getElementById('modalReportar'));
    modal.show();
}

// Función para enviar reporte
function enviarReporte() {
    const form = document.getElementById('form-reportar');
    const formData = new FormData(form);
    
    fetch(resenaSeleccionada.url_reportar, {
        method: 'POST',
        body: formData,
        headers: {
            'X-CSRFToken': formData.get('csrfmiddlewaretoken')
        }
    })
    .then(response => response.json())
    .then(data => {
        if (data.success) {
            // Cerrar modal y mostrar mensaje de éxito
            const modal = bootstrap.Modal.getInstance(document.getElementById('modalReportar'));
            modal.hide();
            
            // Recargar la página para mostrar los cambios
            location.reload();
            
            mostrarNotificacion('✅ Reporte enviado correctamente', 'success');
        } else {
            mostrarNotificacion('❌ Error al enviar el reporte: ' + data.error, 'error');
        }
    })
    .catch(error => {
        console.error('Error:', error);
        mostrarNotificacion('❌ Error al enviar el reporte', 'error');
    });
}

// Función para mostrar notificaciones
function mostrarNotificacion(mensaje, tipo = 'info') {
    const alertClass = {
        'success': 'alert-success',
        'error': 'alert-danger',
        'warning': 'alert-warning',
        'info': 'alert-info'
    }[tipo] || 'alert-info';

    const notificacionHTML = `
        <div class="alert ${alertClass} alert-dismissible fade show notificacion-temporal" role="alert" 
             style="position: fixed; top: 100px; right: 20px; z-index: 1060; min-width: 300px;">
            <i class="fas fa-info-circle me-2"></i>
            ${mensaje}
            <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
        </div>
    `;
    
    document.body.insertAdjacentHTML('beforeend', notificacionHTML);
    
    // Auto-eliminar después de 4 segundos
    setTimeout(() => {
        const alert = document.querySelector('.notificacion-temporal');
        if (alert) {
            alert.remove();
        }
    }, 4000);
}

// Inicializar
document.addEventListener('DOMContentLoaded', function() {
    if (resenasData.length > 0) {
        mostrarResena(0);
    }
    
    // Configurar scroll personalizado para la lista de reseñas
    const contenedorLista = document.querySelector('.contenedor-lista-resenas');
    if (contenedorLista) {
        contenedorLista.style.overflowY = 'auto';
        contenedorLista.style.maxHeight = '60vh';
    }
});
</script>

<style>
/* Estilos generales mejorados basados en el diseño del CRUD */
:root {
    --primary-gradient: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    --secondary-gradient: linear-gradient(135deg, #4F46E5, #7C3AED);
    --success-gradient: linear-gradient(135deg, #10B981, #059669);
    --warning-gradient: linear-gradient(135deg, #F59E0B, #D97706);
    --danger-gradient: linear-gradient(135deg, #EF4444, #DC2626);
}

/* Tarjeta de Bienvenida */
.tarjeta-bienvenida {
    background: var(--primary-gradient);
    color: white;
    padding: 2rem;
    border-radius: 20px;
    box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
    margin-bottom: 2rem;
    position: relative;
    overflow: hidden;
}

.tarjeta-bienvenida::before {
    content: '';
    position: absolute;
    top: -50%;
    right: -50%;
    width: 100%;
    height: 200%;
    background: rgba(255, 255, 255, 0.1);
    transform: rotate(30deg);
}

.tarjeta-bienvenida h2 {
    color: white;
    margin-bottom: 0.5rem;
    font-weight: 700;
    position: relative;
}

.tarjeta-bienvenida p {
    color: rgba(255, 255, 255, 0.9);
    margin-bottom: 0;
    position: relative;
}

/* Estadísticas Grid */
.estadisticas-grid {
    display: grid;
    grid-template-columns: repeat(3, 1fr);
    gap: 1rem;
    margin-top: 1rem;
}

.estadistica-card {
    background: rgba(255, 255, 255, 0.15);
    backdrop-filter: blur(10px);
    padding: 1.5rem;
    border-radius: 15px;
    text-align: center;
    border: 1px solid rgba(255, 255, 255, 0.2);
    transition: all 0.3s ease;
    position: relative;
    overflow: hidden;
}

.estadistica-card:hover {
    transform: translateY(-5px);
    background: rgba(255, 255, 255, 0.25);
}

.estadistica-icono {
    font-size: 2rem;
    margin-bottom: 0.5rem;
    opacity: 0.9;
}

.estadistica-numero {
    font-size: 2.5rem;
    font-weight: 700;
    margin-bottom: 0.25rem;
    color: white;
}

.estadistica-titulo {
    font-size: 0.9rem;
    color: rgba(255, 255, 255, 0.9);
    font-weight: 500;
    text-transform: uppercase;
    letter-spacing: 0.5px;
}

/* Secciones */
.seccion-lista-resenas,
.seccion-detalle-resena {
    background: white;
    border-radius: 15px;
    box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
    overflow: hidden;
    height: fit-content;
    max-height: 80vh;
}

.seccion-header {
    background: #F8FAFC;
    padding: 1.5rem;
    border-bottom: 1px solid #E5E7EB;
    display: flex;
    justify-content: space-between;
    align-items: center;
}

.seccion-header h3 {
    color: #1F2937;
    margin: 0;
    font-weight: 600;
    display: flex;
    align-items: center;
}

.contador-seccion {
    background: var(--secondary-gradient);
    color: white;
    padding: 0.4rem 0.8rem;
    border-radius: 20px;
    font-size: 0.9rem;
    font-weight: 600;
}

/* Lista de Reseñas */
.contenedor-lista-resenas {
    padding: 0;
    max-height: 60vh;
    overflow-y: auto;
}

.lista-resenas {
    display: flex;
    flex-direction: column;
}

.resena-item {
    padding: 1.25rem;
    border-bottom: 1px solid #F3F4F6;
    cursor: pointer;
    transition: all 0.3s ease;
    position: relative;
    border-left: 4px solid transparent;
}

.resena-item:hover {
    background: #F9FAFB;
    transform: translateX(2px);
}

.resena-item.activa {
    background: #4F46E5;
    color: white;
    border-left-color: #4F46E5;
}

.resena-item.activa .resena-cliente,
.resena-item.activa .resena-fecha,
.resena-item.activa .resena-comentario p {
    color: white;
}

.resena-item.activa .resena-estado {
    background: rgba(255, 255, 255, 0.2);
    color: white;
}

.resena-respondida {
    border-left-color: #10B981;
}

.resena-reportada {
    border-left-color: #EF4444;
}

.resena-header {
    display: flex;
    align-items: flex-start;
    gap: 1rem;
    margin-bottom: 0.75rem;
}

.resena-avatar {
    width: 40px;
    height: 40px;
    background: #E5E7EB;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    color: #6B7280;
    flex-shrink: 0;
}

.resena-item.activa .resena-avatar {
    background: rgba(255, 255, 255, 0.2);
    color: white;
}

.resena-info {
    flex: 1;
}

.resena-cliente {
    font-weight: 600;
    color: #1F2937;
    margin-bottom: 0.25rem;
    font-size: 1rem;
}

.resena-meta {
    display: flex;
    gap: 1rem;
    align-items: center;
    flex-wrap: wrap;
}

.resena-fecha {
    font-size: 0.8rem;
    color: #6B7280;
}

.resena-estado {
    padding: 0.2rem 0.6rem;
    border-radius: 12px;
    font-size: 0.75rem;
    font-weight: 500;
}

.estado-respondida {
    background: #D1FAE5;
    color: #065F46;
}

.estado-pendiente {
    background: #FEF3C7;
    color: #92400E;
}

.estado-reportada {
    background: #FEE2E2;
    color: #DC2626;
}

.resena-calificacion {
    text-align: right;
    flex-shrink: 0;
}

.estrellas-resena {
    color: #F59E0B;
    margin-bottom: 0.25rem;
}

.puntuacion {
    font-size: 0.8rem;
    color: #6B7280;
    font-weight: 600;
}

.resena-item.activa .puntuacion {
    color: white;
}

.resena-comentario p {
    color: #6B7280;
    font-size: 0.9rem;
    line-height: 1.4;
    margin: 0;
}

/* Detalle de Reseña */
.contenedor-detalle-resena {
    padding: 1.5rem;
    max-height: 65vh;
    overflow-y: auto;
}

.resena-detalle-completa {
    animation: fadeInUp 0.3s ease;
}

@keyframes fadeInUp {
    from {
        opacity: 0;
        transform: translateY(10px);
    }
    to {
        opacity: 1;
        transform: translateY(0);
    }
}

.resena-detalle-header {
    display: flex;
    justify-content: space-between;
    align-items: flex-start;
    margin-bottom: 2rem;
    padding-bottom: 1.5rem;
    border-bottom: 1px solid #E5E7EB;
}

.resena-info-completa {
    display: flex;
    gap: 1rem;
    align-items: flex-start;
}

.resena-avatar-grande {
    width: 60px;
    height: 60px;
    background: #4F46E5;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    color: white;
    font-size: 1.5rem;
    flex-shrink: 0;
}

.resena-datos h4 {
    color: #1F2937;
    margin-bottom: 0.5rem;
    font-weight: 600;
}

.resena-detalle-meta {
    display: flex;
    gap: 1rem;
    align-items: center;
    flex-wrap: wrap;
}

.fecha-detalle {
    color: #6B7280;
    font-size: 0.9rem;
}

.estado-detalle {
    padding: 0.3rem 0.8rem;
    border-radius: 15px;
    font-size: 0.8rem;
    font-weight: 500;
}

.estado-respondida {
    background: #D1FAE5;
    color: #065F46;
}

.estado-pendiente {
    background: #FEF3C7;
    color: #92400E;
}

.estado-reportada-detalle {
    background: #FEE2E2;
    color: #DC2626;
}

.resena-calificacion-detalle {
    text-align: right;
}

.estrellas-grandes {
    color: #F59E0B;
    font-size: 1.5rem;
    margin-bottom: 0.5rem;
}

.puntuacion-grande {
    font-size: 1.1rem;
    color: #1F2937;
    font-weight: 600;
}

/* Secciones de contenido */
.titulo-seccion {
    color: #374151;
    margin-bottom: 1rem;
    font-weight: 600;
    display: flex;
    align-items: center;
}

.seccion-comentario-cliente,
.seccion-respuesta-existente,
.seccion-formulario-respuesta {
    margin-bottom: 2rem;
}

.comentario-cliente {
    background: #F8FAFC;
    padding: 1.5rem;
    border-radius: 12px;
    border-left: 4px solid #4F46E5;
}

.comentario-cliente p {
    color: #374151;
    line-height: 1.6;
    margin: 0;
}

.respuesta-actual {
    background: #D1FAE5;
    padding: 1.5rem;
    border-radius: 12px;
    border-left: 4px solid #10B981;
}

.respuesta-actual p {
    color: #065F46;
    line-height: 1.6;
    margin: 0;
}

.fecha-respuesta {
    color: #6B7280;
    font-weight: normal;
    font-size: 0.9rem;
}

/* Formulario de Respuesta */
.formulario-respuesta {
    background: #F8FAFC;
    padding: 1.5rem;
    border-radius: 12px;
}

.campo-respuesta {
    position: relative;
    margin-bottom: 1rem;
}

.input-respuesta {
    width: 100%;
    padding: 1rem;
    border: 2px solid #E5E7EB;
    border-radius: 8px;
    font-size: 0.95rem;
    transition: all 0.3s;
    background: white;
    resize: vertical;
    min-height: 120px;
}

.input-respuesta:focus {
    outline: none;
    border-color: #4F46E5;
    box-shadow: 0 0 0 3px rgba(79, 70, 229, 0.1);
}

.contador-caracteres {
    position: absolute;
    bottom: 0.5rem;
    right: 0.5rem;
    font-size: 0.8rem;
    color: #6B7280;
    background: white;
    padding: 0.2rem 0.5rem;
    border-radius: 10px;
}

.acciones-respuesta {
    display: flex;
    gap: 1rem;
    justify-content: flex-end;
}

.btn {
    padding: 0.75rem 1.5rem;
    border: none;
    border-radius: 8px;
    font-weight: 500;
    cursor: pointer;
    transition: all 0.3s;
    display: flex;
    align-items: center;
    gap: 0.5rem;
}

.btn-primario {
    background: var(--secondary-gradient);
    color: white;
}

.btn-primario:hover {
    background: linear-gradient(135deg, #4338CA, #6D28D9);
    transform: translateY(-1px);
    box-shadow: 0 4px 12px rgba(79, 70, 229, 0.3);
}

.btn-secundario {
    background: white;
    color: #6B7280;
    border: 1px solid #E5E7EB;
}

.btn-secundario:hover {
    background: #F3F4F6;
    border-color: #D1D5DB;
}

.btn-outline-danger {
    border-color: #EF4444;
    color: #EF4444;
}

.btn-outline-danger:hover {
    background-color: #EF4444;
    color: white;
}

/* Estados Vacío */
.estado-vacio {
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    padding: 3rem;
    text-align: center;
    color: #6B7280;
}

.estado-vacio i {
    margin-bottom: 1rem;
    opacity: 0.5;
}

.estado-vacio h4 {
    color: #6B7280;
    margin-bottom: 0.5rem;
}

.estado-vacio p {
    margin-bottom: 0;
}

.seccion-acciones-resena {
    margin-top: 2rem;
    padding-top: 1.5rem;
    border-top: 1px solid #E5E7EB;
}

.acciones-respuesta {
    display: flex;
    gap: 1rem;
    justify-content: space-between;
    align-items: center;
}

/* Responsive */
@media (max-width: 1200px) {
    .resena-detalle-header {
        flex-direction: column;
        gap: 1rem;
    }
    
    .resena-calificacion-detalle {
        text-align: left;
    }
}

@media (max-width: 992px) {
    .seccion-lista-resenas,
    .seccion-detalle-resena {
        max-height: none;
    }
    
    .contenedor-lista-resenas,
    .contenedor-detalle-resena {
        max-height: 50vh;
    }
}

@media (max-width: 768px) {
    .estadisticas-grid {
        grid-template-columns: 1fr;
    }
    
    .acciones-respuesta {
        flex-direction: column;
        gap: 0.5rem;
    }
    
    .acciones-respuesta .btn {
        width: 100%;
    }
    
    .resena-detalle-header {
        flex-direction: column;
        gap: 1rem;
    }
    
    .resena-info-completa {
        flex-direction: column;
        text-align: center;
    }
}

@media (max-width: 576px) {
    .tarjeta-bienvenida {
        padding: 1.5rem;
    }
    
    .seccion-header {
        padding: 1rem;
        flex-direction: column;
        gap: 1rem;
        align-items: flex-start;
    }
    
    .contenedor-lista-resenas,
    .contenedor-detalle-resena {
        padding: 1rem;
    }
    
    .resena-item {
        padding: 1rem;
    }
    
    .resena-meta {
        flex-direction: column;
        align-items: flex-start;
        gap: 0.5rem;
    }
}
</style>
{% endblock %}