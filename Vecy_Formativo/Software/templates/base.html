{% load static %}
<!DOCTYPE html>
<html lang="es">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/css/bootstrap.min.css" rel="stylesheet"
    integrity="sha384-sRIl4kxILFvY47J16cr9ZwB07vP4J8+LH7qKQnuqkuIAvNWLzeN8tE5YBujZqJLB" crossorigin="anonymous">
  <link href="https://cdn.jsdelivr.net/npm/aos@2.3.4/dist/aos.css" rel="stylesheet" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" />
  {% block extra_css %}{% endblock %}
  <title>{% block title %}VECY{% endblock %}</title>
    <style>
    :root {
      --primary: #3598db;
      --secondary: #34495e;
      --dark: #2d3e50;
      --light: #f8f9fb;
      --white: #ffffff;
      --shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
      --transition: all 0.3s ease;
    }

    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    }

    body {
      background-color: var(--light);
      color: var(--dark);
      overflow-x: hidden;
    }

    /* Header Styles */
    .header {
      background-color: var(--white);
      box-shadow: var(--shadow);
      position: sticky;
      top: 0;
      z-index: 1000;
      padding: 15px 0;
    }

    .logo {
      font-weight: 700;
      font-size: 1.8rem;
      color: var(--primary);
      text-decoration: none;
    }

    .logo span {
      color: var(--secondary);
    }

    .logo:hover {
      color: var(--primary);
      text-decoration: none;
    }

    .search-container {
      position: relative;
      max-width: 500px;
    }

    .search-input {
      border-radius: 50px;
      padding: 10px 20px;
      border: 2px solid var(--light);
      transition: var(--transition);
      width: 100%;
    }

    .search-input:focus {
      border-color: var(--primary);
      box-shadow: 0 0 0 0.25rem rgba(53, 152, 219, 0.25);
    }

    .search-btn {
      position: absolute;
      right: 5px;
      top: 5px;
      background: var(--primary);
      color: white;
      border: none;
      border-radius: 50px;
      padding: 7px 15px;
      transition: var(--transition);
    }

    .search-btn:hover {
      background: var(--secondary);
    }

    .btn-primary-custom {
      background: var(--primary);
      color: white;
      border: none;
      border-radius: 50px;
      padding: 10px 25px;
      transition: var(--transition);
      font-weight: 600;
      text-decoration: none;
      display: inline-block;
      text-align: center;
    }

    .btn-primary-custom:hover {
      background: var(--secondary);
      transform: translateY(-2px);
      color: white;
      text-decoration: none;
    }

    .btn-outline-custom {
      border: 2px solid var(--primary);
      color: var(--primary);
      background: transparent;
      border-radius: 50px;
      padding: 10px 25px;
      transition: var(--transition);
      font-weight: 600;
      text-decoration: none;
      display: inline-block;
      text-align: center;
    }

    .btn-outline-custom:hover {
      background: var(--primary);
      color: white;
      transform: translateY(-2px);
      text-decoration: none;
    }

    /* Nav Icons */
    .nav-icon {
      position: relative;
      color: var(--dark);
      text-decoration: none;
      padding: 8px 12px;
      border-radius: 10px;
      transition: var(--transition);
    }

    .nav-icon:hover {
      background: var(--light);
      color: var(--primary);
    }

    .nav-icon .badge {
      position: absolute;
      top: -5px;
      right: 0;
      background: #e74c3c;
      color: white;
      border-radius: 50%;
      width: 18px;
      height: 18px;
      font-size: 0.7rem;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    /* User dropdown */
    .user-dropdown .dropdown-toggle {
      background: var(--primary);
      border: none;
      border-radius: 50px;
      padding: 8px 20px;
      color: white;
      font-weight: 600;
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .user-dropdown .dropdown-toggle:hover {
      background: var(--secondary);
    }

    .user-avatar {
      width: 32px;
      height: 32px;
      border-radius: 50%;
      object-fit: cover;
      border: 2px solid white;
    }

    .dropdown-menu {
      border: none;
      box-shadow: var(--shadow);
      border-radius: 10px;
      padding: 10px 0;
    }

    .dropdown-item {
      padding: 8px 20px;
      display: flex;
      align-items: center;
      gap: 10px;
      transition: var(--transition);
    }

    .dropdown-item:hover {
      background: var(--light);
      color: var(--primary);
    }

    .dropdown-divider {
      margin: 8px 0;
    }

    /* Cart Dropdown */
    .cart-dropdown {
      min-width: 300px;
      max-width: 400px;
    }

    .cart-item {
      display: flex;
      align-items: center;
      padding: 10px 15px;
      border-bottom: 1px solid var(--light);
    }

    .cart-item:last-child {
      border-bottom: none;
    }

    .cart-item-img {
      width: 50px;
      height: 50px;
      border-radius: 8px;
      object-fit: cover;
      margin-right: 10px;
    }

    .cart-item-info {
      flex: 1;
    }

    .cart-item-name {
      font-weight: 600;
      font-size: 0.9rem;
      margin-bottom: 2px;
    }

    .cart-item-price {
      color: var(--primary);
      font-weight: 600;
    }

    .cart-item-quantity {
      font-size: 0.8rem;
      color: var(--secondary);
    }

    .cart-total {
      padding: 15px;
      background: var(--light);
      border-top: 1px solid var(--light);
    }

    /* Notifications */
    .notification-dropdown {
      min-width: 300px;
      max-width: 400px;
    }

    .notification-item {
      padding: 10px 15px;
      border-bottom: 1px solid var(--light);
      transition: var(--transition);
    }

    .notification-item:last-child {
      border-bottom: none;
    }

    .notification-item:hover {
      background: var(--light);
    }

    .notification-item.unread {
      background: rgba(52, 152, 219, 0.05);
    }

    .notification-icon {
      width: 30px;
      height: 30px;
      border-radius: 50%;
      background: var(--primary);
      color: white;
      display: flex;
      align-items: center;
      justify-content: center;
      margin-right: 10px;
    }

    .notification-content {
      flex: 1;
    }

    .notification-title {
      font-weight: 600;
      font-size: 0.9rem;
      margin-bottom: 2px;
    }

    .notification-time {
      font-size: 0.7rem;
      color: var(--secondary);
    }

    /* Mobile menu */
    .mobile-menu-btn {
      border: none;
      background: none;
      font-size: 1.5rem;
      color: var(--dark);
    }

    /* Messages */
    .messages-container {
      position: fixed;
      top: 80px;
      left: 50%;
      transform: translateX(-50%);
      z-index: 1050;
      width: 90%;
      max-width: 500px;
    }

    /* Responsive */
    @media (max-width: 768px) {
      .nav-icons {
        position: fixed;
        bottom: 0;
        left: 0;
        right: 0;
        background: var(--white);
        box-shadow: 0 -2px 10px rgba(0, 0, 0, 0.1);
        padding: 10px;
        z-index: 1000;
        display: flex;
        justify-content: space-around;
      }

      .nav-icon {
        flex-direction: column;
        font-size: 0.8rem;
        padding: 5px 10px;
      }

      .nav-icon i {
        font-size: 1.2rem;
        margin-bottom: 2px;
      }

      .user-dropdown {
        display: none;
      }
    }
  </style>
</head>

<body>
  <!-- Header -->
  <header class="header">
    <div class="container">
      <div class="row align-items-center">
        <!-- Logo -->
        <div class="col-lg-2 col-6">
          <a href="{% url 'principal' %}" class="logo">
            VECY
          </a>
        </div>

        <!-- Search Bar -->
        <div class="col-lg-5 d-none d-lg-block">
          <div class="search-container">
            <input type="text" class="search-input" placeholder="Buscar productos, negocios...">
            <button class="search-btn">
              <i class="fas fa-search"></i>
            </button>
          </div>
        </div>

        <!-- Navigation Icons -->
        <div class="col-lg-5 col-6 text-end">
          {% if request.user.is_authenticated %}
          <div class="d-flex align-items-center justify-content-end gap-3">
            <!-- Wishlist -->
            <a href="" class="nav-icon position-relative" title="Favoritos">
              <i class="fas fa-heart"></i>
              <span class="badge" id="wishlist-count">0</span>
            </a>

            <!-- Notifications -->
            <div class="dropdown">
              <a href="#" class="nav-icon position-relative" title="Notificaciones" data-bs-toggle="dropdown">
                <i class="fas fa-bell"></i>
                <span class="badge" id="notification-count">3</span>
              </a>
              <div class="dropdown-menu dropdown-menu-end notification-dropdown">
                <div class="d-flex justify-content-between align-items-center px-3 py-2 border-bottom">
                  <h6 class="mb-0">Notificaciones</h6>
                  <a href="#" class="small text-primary">Marcar todas</a>
                </div>
                <div class="notification-item unread">
                  <div class="d-flex align-items-center">
                    <div class="notification-icon">
                      <i class="fas fa-store"></i>
                    </div>
                    <div class="notification-content">
                      <div class="notification-title">Nuevo producto disponible</div>
                      <div class="notification-time">Hace 5 min</div>
                    </div>
                  </div>
                </div>
                <div class="notification-item">
                  <div class="d-flex align-items-center">
                    <div class="notification-icon" style="background: #2ecc71;">
                      <i class="fas fa-tag"></i>
                    </div>
                    <div class="notification-content">
                      <div class="notification-title">Oferta especial</div>
                      <div class="notification-time">Hace 1 hora</div>
                    </div>
                  </div>
                </div>
                <div class="text-center py-2">
                  <a href="" class="text-primary small">Ver todas</a>
                </div>
              </div>
            </div>

            <!-- Shopping Cart -->
            <div class="dropdown">
              <a href="#" class="nav-icon position-relative" title="Carrito" data-bs-toggle="dropdown">
                <i class="fas fa-shopping-cart"></i>
                <span class="badge" id="cart-count">0</span>
              </a>
              <div class="dropdown-menu dropdown-menu-end cart-dropdown">
                <div class="d-flex justify-content-between align-items-center px-3 py-2 border-bottom">
                  <h6 class="mb-0">Carrito de Compras</h6>
                  <span class="badge bg-primary" id="cart-items-count">0 items</span>
                </div>
                <div id="cart-items-container">
                  <!-- Cart items will be loaded here dynamically -->
                  <div class="text-center py-4 text-muted">
                    <i class="fas fa-shopping-cart fa-2x mb-2"></i>
                    <p>Tu carrito está vacío</p>
                  </div>
                </div>
                <div class="cart-total">
                  <div class="d-flex justify-content-between align-items-center mb-2">
                    <strong>Total:</strong>
                    <span class="h6 mb-0 text-primary" id="cart-total">$0.00</span>
                  </div>
                  <!-- Shopping Cart -->
                  <a href="#" class="nav-icon position-relative" title="Carrito" data-bs-toggle="offcanvas"
                    data-bs-target="#cartOffcanvas">
                    <i class="fas fa-shopping-cart"></i>
                    <span class="badge" id="cart-count">{{ carrito_count|default:0 }}</span>
                  </a>
                </div>
              </div>
            </div>

            <!-- User Menu -->
            <div class="dropdown user-dropdown">
              <button class="btn dropdown-toggle" type="button" id="userDropdown" data-bs-toggle="dropdown"
                aria-expanded="false">
                {% if request.session.usuario_imagen %}
                <img src="{{ request.session.usuario_imagen }}" alt="{{ request.session.usuario_nombre }}"
                  class="user-avatar">
                {% else %}
                <i class="fas fa-user-circle me-1"></i>
                {% endif %}
                {{ request.session.usuario_nombre }}
              </button>
              <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="userDropdown">
                <li><a class="dropdown-item" href=""><i class="fas fa-user me-2"></i>Mi Perfil</a></li>
                <li><a class="dropdown-item" href=""><i class="fas fa-shopping-bag me-2"></i>Mis Pedidos</a></li>
                <li><a class="dropdown-item" href=""><i class="fas fa-heart me-2"></i>Favoritos</a></li>
                <li><a class="dropdown-item" href=""><i class="fas fa-star me-2"></i>Mis Reseñas</a></li>
                <li>
                  <hr class="dropdown-divider">
                </li>
                <li><a class="dropdown-item" href=""><i class="fas fa-cog me-2"></i>Configuración</a></li>
                <li><a class="dropdown-item" href=""><i class="fas fa-question-circle me-2"></i>Ayuda</a></li>
                <li>
                  <hr class="dropdown-divider">
                </li>
                <li><a class="dropdown-item" href="{% url 'cerrar_sesion' %}"><i
                      class="fas fa-sign-out-alt me-2"></i>Cerrar Sesión</a></li>
              </ul>
            </div>
          </div>
          {% else %}
          <!-- Guest User -->
          <div class="d-flex justify-content-end gap-2">
            <a href="{% url 'iniciar_sesion' %}" class="btn btn-outline-custom">Iniciar Sesión</a>
            <a href="{% url 'registro_usuario' %}" class="btn btn-primary-custom">Registrarse</a>
          </div>
          {% endif %}
        </div>
      </div>
    </div>
  </header>

  <!-- Mobile Navigation -->
  {% if request.session.usuario_id %}
  <nav class="nav-icons d-lg-none">
    <a href="{% url 'principal' %}" class="nav-icon">
      <i class="fas fa-home"></i>
      <span>Inicio</span>
    </a>
    <a href="" class="nav-icon">
      <i class="fas fa-heart"></i>
      <span>Favoritos</span>
    </a>
    <a href="" class="nav-icon">
      <i class="fas fa-shopping-cart"></i>
      <span>Carrito</span>
    </a>
    <a href="" class="nav-icon">
      <i class="fas fa-shopping-bag"></i>
      <span>Pedidos</span>
    </a>
    <a href="" class="nav-icon">
      <i class="fas fa-user"></i>
      <span>Perfil</span>
    </a>
  </nav>
  {% endif %}

  <!-- Messages -->
  {% if messages %}
  <div class="messages-container">
    {% for message in messages %}
    <div
      class="alert alert-{% if message.tags == 'error' %}danger{% else %}{{ message.tags }}{% endif %} alert-dismissible fade show"
      role="alert">
      {{ message }}
      <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
    </div>
    {% endfor %}
  </div>
  {% endif %}

  <!-- Main Content -->
  <main style="margin-bottom: {% if request.session.usuario_id %}80px{% else %}0{% endif %};">
    {% block content %}
    <!-- El contenido específico de cada página irá aquí -->
    {% endblock %}
  </main>

  <!-- Footer -->
  <footer class="bg-dark text-white py-5 mt-5">
    <div class="container">
      <div class="row">
        <div class="col-lg-4 mb-4">
          <h4 class="text-white mb-3">VECY</h4>
          <p class="text-light">La plataforma que conecta negocios locales con clientes en tu comunidad.</p>
        </div>
        <div class="col-lg-2 mb-4">
          <h5 class="mb-3">Enlaces Rápidos</h5>
          <ul class="list-unstyled">
            <li class="mb-2"><a href="{% url 'principal' %}" class="text-light text-decoration-none">Inicio</a></li>
            <li class="mb-2"><a href="#categorias" class="text-light text-decoration-none">Categorías</a></li>
            <li class="mb-2"><a href="#" class="text-light text-decoration-none">Negocios</a></li>
            <li class="mb-2"><a href="#" class="text-light text-decoration-none">Productos</a></li>
          </ul>
        </div>
        <div class="col-lg-3 mb-4">
          <h5 class="mb-3">Cuenta</h5>
          <ul class="list-unstyled">
            <li class="mb-2"><a href="{% url 'iniciar_sesion' %}" class="text-light text-decoration-none">Iniciar
                Sesión</a></li>
            <li class="mb-2"><a href="{% url 'registro_usuario' %}"
                class="text-light text-decoration-none">Registrarse</a></li>
            <li class="mb-2"><a href="{% url 'cambiar_contrasena' %}"
                class="text-light text-decoration-none">Recuperar Contraseña</a></li>
          </ul>
        </div>
        <div class="col-lg-3 mb-4">
          <h5 class="mb-3">Contacto</h5>
          <ul class="list-unstyled text-light">
            <li class="mb-2"><i class="fas fa-map-marker-alt me-2"></i> Dirección: Calle Principal 123</li>
            <li class="mb-2"><i class="fas fa-phone me-2"></i> Teléfono: +1 234 567 890</li>
            <li class="mb-2"><i class="fas fa-envelope me-2"></i> Email: info@vecy.com</li>
          </ul>
        </div>
      </div>
      <hr class="bg-light">
      <div class="row align-items-center">
        <div class="col-md-6">
          <p class="mb-0">&copy; 2024 VECY. Todos los derechos reservados.</p>
        </div>
        <div class="col-md-6 text-md-end">
          <a href="#" class="text-light me-3"><i class="fab fa-facebook fa-lg"></i></a>
          <a href="#" class="text-light me-3"><i class="fab fa-twitter fa-lg"></i></a>
          <a href="#" class="text-light"><i class="fab fa-instagram fa-lg"></i></a>
        </div>
      </div>
    </div>
  </footer>

  <!-- Bootstrap JS -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>

  {% block scripts %}{% endblock %}
</body>

</html>